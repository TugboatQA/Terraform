services:
  terraform:
    image: tugboatqa/httpd:2.4
  
    commands:
      init:
        # Download Terraform
        - wget https://releases.hashicorp.com/terraform/0.11.10/terraform_0.11.10_linux_amd64.zip
        - unzip ./terraform_0.11.10_linux_amd64.zip
        - rm ./terraform_0.11.10_linux_amd64.zip
        - ln -sf ./terraform /usr/local/bin/terraform
        
      build:
        # Define variables for Terraform to use. 
        - sed -in "s/aws_access_key/${aws_access_key}/g" "example.tf"
        - sed -in "s/aws_secret_key/${aws_secret_key}/g" "example.tf"
        
        # Initialize the backend and provider plugins.
        - ./terraform init
       
